{
  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "Parameters": {
    "Workspace": {
      "type": "string"
    }
  },
  "resources": [
    {
      "id": "[concat(resourceId('Microsoft.OperationalInsights/workspaces/providers', parameters('workspace'), 'Microsoft.SecurityInsights'),'/alertRules/7ce5956f-48f2-42f5-8e2e-c254e7643c11')]",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/7ce5956f-48f2-42f5-8e2e-c254e7643c11')]",
      "type": "Microsoft.OperationalInsights/workspaces/providers/alertRules",
      "kind": "Scheduled",
      "apiVersion": "2021-03-01-preview",
      "properties": {
        "alertDetailsOverride": {
          "alertDescriptionFormat": "{{summary_s}}",
          "alertDisplayNameFormat": "{{incidentName_s}}"
        },
        "description": "'Monitors Contrast ADR security incidents across all applications and environments. This rule creates alerts for all security incidents detected by Contrast Security ADR, providing comprehensive visibility into application security events requiring investigation.'\n",
        "incidentConfiguration": {
          "groupingConfiguration": {
            "groupByCustomDetails": [
              "IncidentId",
              "ApplicationName"
            ],
            "lookbackDuration": "PT1H",
            "reopenClosedIncident": false,
            "enabled": true,
            "matchingMethod": "Selected"
          },
          "createIncident": true
        },
        "query": "ContrastADRIncident_CL\n",
        "queryFrequency": "5m",
        "status": "Available",
        "name": "Contrast ADR - Security Incident Alert",
        "tactics": [
          "InitialAccess",
          "DefenseEvasion",
          "Discovery",
          "CommandAndControl"
        ],
        "eventGroupingSettings": {
          "aggregationKind": "AlertPerResult"
        },
        "severity": "Medium",
        "entityMappings": [
          {
            "entityType": "SecurityGroup",
            "fieldMappings": [
              {
                "identifier": "ObjectGuid",
                "columnName": "incidentId_s"
              }
            ]
          }
        ],
        "queryPeriod": "5m",
        "triggerOperator": "gt",
        "triggerThreshold": 0
      }
    }
  ]
}
