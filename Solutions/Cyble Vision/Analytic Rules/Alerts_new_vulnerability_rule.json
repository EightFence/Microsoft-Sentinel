{
  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "Parameters": {
    "Workspace": {
      "type": "string"
    }
  },
  "resources": [
    {
      "id": "[concat(resourceId('Microsoft.OperationalInsights/workspaces/providers', parameters('workspace'), 'Microsoft.SecurityInsights'),'/alertRules/e52f36dd-7d4f-4aa8-a095-3b6fa2b28b8d')]",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/e52f36dd-7d4f-4aa8-a095-3b6fa2b28b8d')]",
      "type": "Microsoft.OperationalInsights/workspaces/providers/alertRules",
      "kind": "Scheduled",
      "apiVersion": "2021-03-01-preview",
      "properties": {
        "queryPeriod": "30m",
        "status": "Available",
        "name": "Cyble Vision Alerts New Vulnerability Detected",
        "severity": "Low",
        "query": "Alerts_new_vulnerability  \n| where Service == \"new_vulnerability\" \n| extend MappedSeverity = Severity\n",
        "triggerThreshold": 0,
        "triggerOperator": "GreaterThan",
        "tactics": [
          "InitialAccess"
        ],
        "customDetails": {
          "Status": "Status",
          "AlertID": "AlertID",
          "NV_CVE": "NV_CVE",
          "Service": "Service",
          "MappedSeverity": "Severity"
        },
        "description": "'A newly detected CVE has been associated with a monitored keyword or asset. This may indicate exposure to newly published or exploited vulnerabilities.'\n",
        "queryfrequency": "30m",
        "incidentConfiguration": {
          "severityColumnName": "MappedSeverity",
          "alertDisplayNameFormat": "New Vulnerability Identified {{NV_CVE}}",
          "alertDetailsOverride": null,
          "createIncident": true,
          "description": "A new vulnerability ({{NV_CVE}}) has been identified for one of the monitored keywords or assets. This CVE may pose risks depending on exposure and exploitability. Review CVE details and assess potential impact on your environment.\n",
          "groupingConfiguration": {
            "matchingMethod": "AllEntities",
            "enabled": false,
            "reopenClosedIncident": false,
            "lookbackDuration": "PT5H"
          }
        },
        "enabled": true,
        "entityMappings": null,
        "eventGroupingSettings": {
          "aggregationKind": "AlertPerResult"
        }
      }
    }
  ]
}
