{
  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "Parameters": {
    "Workspace": {
      "type": "string"
    }
  },
  "resources": [
    {
      "id": "[concat(resourceId('Microsoft.OperationalInsights/workspaces/providers', parameters('workspace'), 'Microsoft.SecurityInsights'),'/alertRules/83fbf6a2-f227-48f4-8e7b-0b0ecac2381b')]",
      "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/83fbf6a2-f227-48f4-8e7b-0b0ecac2381b')]",
      "type": "Microsoft.OperationalInsights/workspaces/providers/alertRules",
      "kind": "Scheduled",
      "apiVersion": "2021-03-01-preview",
      "properties": {
        "sentinelEntitiesMappings": null,
        "description": "'The analytic rule creates an incident when an alert is created in Atlassian Beacon. The webhook payload by itself does not provide much information about the alert, apart from the alertId, alertDetailURL, alertTitle. Navigate to the alertDetailURL to view more information on who is impacted and what actions need to be taken.'\n",
        "tactics": [],
        "entityMappings": null,
        "suppressionEnabled": false,
        "name": "Atlassian Beacon Alert",
        "queryPeriod": "5m",
        "query": "atlassian_beacon_alerts_CL\n| project TimeGenerated, alertTitle_s, alertDetailURL_s, alertId_s, detectiontime_d, Type\n",
        "customDetails": null,
        "eventGroupingSettings": {
          "aggregationKind": "SingleAlert"
        },
        "severity": "High",
        "suppressionDuration": "5h",
        "triggerOperator": "gt",
        "queryFrequency": "5m",
        "triggerThreshold": 0,
        "alertDetailsOverride": {
          "alertDisplayNameFormat": "Atlassian Beacon - {alertTitle_s}"
        },
        "incidentConfiguration": {
          "groupingConfiguration": {
            "lookbackDuration": "5h",
            "enabled": true,
            "reopenClosedIncident": false,
            "matchingMethod": "AllEntities"
          },
          "createIncident": true
        }
      }
    }
  ]
}
